function [f, df, d2f] = himmelblau(x)
    f = (x(1)^2 + x(2) - 11)^2 + (x(1) + x(2)^2 - 7)^2;
    if nargout > 1
        df = [4*x(1)*(x(1)^2 + x(2) - 11) + 2*(x(1) + x(2)^2 - 7); 2*(x(1)^2 + x(2) - 11) + 4*x(2)*(x(1) + x(2)^2 - 7)];
        if nargout > 2
            d2f = [12*x(1)^2 + 4*x(2) - 42, 4*(x(1) + x(2)); 4*(x(1) + x(2)), 4*x(1) + 12*x(2)^2 - 26];
        end
    end
end